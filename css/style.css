body {
    font-family: 'Noto Sans JP', sans-serif;
    background-color: #1a1a1a;
    color: white;
    overflow: hidden;
    touch-action: manipulation;
}

.game-board {
    background: radial-gradient(circle, #358f44 0%, #215a2a 100%);
    box-shadow: inset 0 0 50px rgba(0, 0, 0, 0.5);
    transition: background 1s ease;
}

.revolution-mode {
    background: radial-gradient(circle, #8f3535 0%, #5a2121 100%) !important;
}

.screen {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 50;
    background: #1a1a1a;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

.hidden {
    display: none !important;
}

/* Order List Items */
.order-item {
    background-color: rgba(255, 255, 255, 0.1);
    padding: 0.75rem 1rem;
    border-radius: 0.5rem;
    cursor: grab;
    display: flex;
    align-items: center;
    justify-content: space-between;
    transition: background-color 0.2s, transform 0.1s;
}

.order-item:active {
    cursor: grabbing;
    background-color: rgba(255, 255, 255, 0.2);
    transform: scale(1.02);
}

.order-item.dragging {
    opacity: 0.5;
}

/* Ranking Items */
.ranking-item {
    background-color: rgba(0, 0, 0, 0.5);
    padding: 1rem;
    border-radius: 0.5rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
    font-size: 1.2rem;
    font-weight: bold;
}

.ranking-1st {
    border-left: 5px solid #FFD700;
    color: #FFD700;
}

.ranking-2nd {
    border-left: 5px solid #C0C0C0;
    color: #C0C0C0;
}

.ranking-3rd {
    border-left: 5px solid #CD7F32;
    color: #CD7F32;
}

.ranking-4th {
    border-left: 5px solid #555;
    color: #888;
}


/* Card Styles */
.card {
    width: 3.5rem;
    height: 5rem;
    background-color: white;
    border-radius: 0.375rem;
    box-shadow: 1px 1px 4px rgba(0, 0, 0, 0.3);
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    padding: 0.25rem;
    position: relative;
    user-select: none;
    transition: transform 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
    cursor: pointer;
    color: #333;
    border: 1px solid #ccc;
    /* Default border */
}

.suit-red {
    color: #e53e3e;
}

.suit-black {
    color: #2d3748;
}

/* Responsive Hand Container */
.hand-container {
    display: flex;
    justify-content: center;
    align-items: flex-end;
    /* Use min-height and allow flex grow/shrink */
    min-height: 8rem;
    width: 100%;
    padding: 0 1rem;
    gap: 0.25rem;
    flex-wrap: wrap;
    align-content: flex-end;
}

/* Improve button positioning for wrapped rows */
/* When wrapped, we want to ensure buttons don't overlap */
#player-area-0 {
    /* Ensure z-index is high so it interacts properly */
    z-index: 30;
}

/* Move buttons to right if constrained? No, keeping them centered above is fine if we allow height growth. 
   But user asked to Shift them if wrapped.
   Since we don't know if wrapped easily in CSS without Container Queries or JS Check,
   Making the container auto-height (min-h) and pushing buttons up *should* work 
   as long as buttons are in normal flow before the hand.
   Currently structure is: Buttons (block) -> Hand (block)
   So Buttons are naturally ABOVE hand.
   The overlap happened because of Fixed Height h-48 + Flex Justify End.
   Removing Fixed Height fixes the overlap 99% of time.
   Also adding a check for very small screens.
*/
.action-buttons {
    z-index: 40;
    pointer-events: auto;
}

.hand-card {
    transition: transform 0.2s, box-shadow 0.2s, border-color 0.2s;
    box-shadow: -2px 0 5px rgba(0, 0, 0, 0.1);
    background-color: white;
    margin-bottom: 0.5rem;
    /* Prevent shrinking too much */
    flex-shrink: 0;
}

.hand-card.selected {
    transform: translateY(-1.5rem) scale(1.1);
    z-index: 10;
    box-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
    border: 3px solid #FFD700;
}

/* Exchange Overlay Specifics */
#ex-hand-area .hand-card {
    cursor: pointer;
    transform: scale(1.2);
    /* Make them bigger in overlay */
    margin: 0.5rem;
}

#ex-hand-area .hand-card.selected {
    border-color: #FFD700;
    /* Just border in overlay, maybe no jump */
    transform: scale(1.3) translateY(-10px);
}

.field-card {
    position: absolute;
    transform-origin: center center;
    transition: all 0.3s ease-out;
}

/* Bubbles and Badges */
.bubble {
    position: relative;
    background: rgba(255, 255, 255, 0.95);
    color: #333;
    padding: 0.5rem 0.8rem;
    border-radius: 1rem;
    font-size: 0.75rem;
    max-width: 160px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    opacity: 0;
    transition: opacity 0.3s;
    pointer-events: none;
    white-space: pre-wrap;
    z-index: 40;
}

.bubble.visible {
    opacity: 1;
}

.bubble::after {
    content: '';
    position: absolute;
    border-style: solid;
    border-width: 6px;
}

.bubble-bottom::after {
    bottom: -10px;
    left: 50%;
    margin-left: -6px;
    border-color: rgba(255, 255, 255, 0.95) transparent transparent transparent;
}

.bubble-right::after {
    top: 50%;
    right: -10px;
    margin-top: -6px;
    border-color: transparent transparent transparent rgba(255, 255, 255, 0.95);
}

.bubble-left::after {
    top: 50%;
    left: -10px;
    margin-top: -6px;
    border-color: transparent rgba(255, 255, 255, 0.95) transparent transparent;
}

.card-count-badge {
    background-color: #e53e3e;
    color: white;
    font-weight: bold;
    font-size: 0.7rem;
    width: 1.2rem;
    height: 1.2rem;
    border-radius: 9999px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    bottom: -2px;
    right: -2px;
    border: 2px solid #2d3748;
}

.active-turn {
    box-shadow: 0 0 15px 5px rgba(255, 255, 100, 0.6);
    border-radius: 9999px;
    transition: box-shadow 0.3s;
}

/* Character Selection Items */
.char-select-item {
    transition: all 0.2s;
}

.char-select-item:hover {
    background-color: rgba(255, 255, 255, 0.1);
}

.char-select-item input:checked+div {
    border-color: #3b82f6;
    background-color: rgba(59, 130, 246, 0.2);
}